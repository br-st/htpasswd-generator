<!DOCTYPE html>
		<html lang="en">
		<head>
			<meta charset="UTF-8">
			<meta name="viewport" content="width=device-width, initial-scale=1.0">
			<title>htpasswd & Group Generator</title>
			<style>
				/* --- DARK MODE THEME --- */
				body {
					font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
					line-height: 1.6;
					background-color: #1e1e1e;
					color: #f5f5f5;
					margin: 0;
					padding: 20px;
				}
				.container {
					max-width: 720px;
					margin: 20px auto;
					padding: 30px;
					background-color: #2c2c2c;
					border-radius: 12px;
					border: 1px solid #444;
					box-shadow: 0 4px 12px rgba(0,0,0,0.2);
				}
		
				/* --- ICONS --- */
				.icon {
					width: 20px;
					height: 20px;
					stroke: currentColor;
					stroke-width: 2;
					stroke-linecap: round;
					stroke-linejoin: round;
					fill: none;
				}
				.icon-lg {
					width: 28px;
					height: 28px;
					vertical-align: bottom;
					margin-right: 10px;
					color: #8ab4f8;
				}
				
				h1 {
					text-align: center;
					color: #8ab4f8;
					margin-bottom: 10px;
					display: flex;
					align-items: center;
					justify-content: center;
				}
				p {
					text-align: center;
					font-size: 0.95rem;
					color: #c0c0c0;
					margin-bottom: 30px;
				}
				form {
					display: grid;
					gap: 20px;
				}
				.user-entry {
					display: grid;
					grid-template-columns: 1fr 1fr 1fr auto;
					gap: 10px;
					align-items: flex-end;
					padding: 15px;
					border: 1px solid #444;
					border-radius: 8px;
					background-color: #333;
				}
				.form-group {
					display: grid;
					gap: 8px;
				}
				.password-wrapper {
					position: relative;
					display: flex;
				}
				label {
					font-weight: 600;
					font-size: 0.8rem;
					color: #aaa;
					text-transform: uppercase;
					letter-spacing: 0.5px;
				}
				input[type="text"],
				input[type="password"],
				select {
					width: 100%;
					padding: 12px;
					font-size: 1rem;
					border: 1px solid #555;
					background-color: #3a3a3a;
					color: #f5f5f5;
					border-radius: 8px;
					box-sizing: border-box; 
				}
				input:focus, select:focus {
					outline: none;
					border-color: #4285F4;
					background-color: #404040;
				}
				input.password {
					padding-right: 45px;
				}
				
				/* Toggle Password Button (Eye) */
				.toggle-password {
					position: absolute;
					right: 2px;
					top: 2px;
					bottom: 2px;
					width: 40px;
					background: transparent;
					border: none;
					border-radius: 0 8px 8px 0;
					cursor: pointer;
					color: #bbb; /* Explicit color for visibility */
					display: flex;
					align-items: center;
					justify-content: center;
					transition: color 0.2s;
				}
				.toggle-password:hover {
					color: #fff;
					background-color: rgba(255,255,255,0.1);
				}
		
				/* Main Buttons */
				button {
					padding: 12px 20px;
					font-size: 1rem;
					font-weight: 600;
					color: #ffffff;
					background-color: #4285F4;
					border: none;
					border-radius: 8px;
					cursor: pointer;
					transition: background-color 0.2s ease;
					display: flex;
					align-items: center;
					justify-content: center;
					gap: 8px;
				}
				button:hover {
					background-color: #3367d6;
				}
				
				button.add-btn {
					background-color: #1e88e5;
					justify-self: start;
				}
				button.add-btn:hover {
					background-color: #1565c0;
				}
		
				button.remove-btn {
					background-color: #e53935; 
					color: white;
					padding: 0;
					width: 47px;
					height: 47px; 
				}
				button.remove-btn:hover {
					background-color: #c62828;
				}
		
				h3 {
					margin-top: 30px;
					border-bottom: 1px solid #444;
					padding-bottom: 5px;
					color: #8ab4f8;
				}
				.output-container {
					position: relative;
					margin-bottom: 20px;
				}
				pre {
					background-color: #1a1a1a; /* Darker than background */
					color: #eceff1;
					padding: 20px;
					border-radius: 8px;
					border: 1px solid #444;
					font-family: "Menlo", "Consolas", monospace;
					font-size: 0.9rem;
					white-space: pre-wrap;
					word-wrap: break-word;
					line-height: 1.5;
					min-height: 50px;
				}
				.copy-btn {
					position: absolute;
					top: 12px;
					right: 12px;
					background-color: #37474f;
					color: white;
					border: 1px solid #546e7a;
					border-radius: 6px;
					padding: 6px 12px;
					font-size: 0.8rem;
					font-weight: 500;
					cursor: pointer;
					transition: all 0.2s ease;
					display: flex;
					align-items: center;
					gap: 6px;
				}
				.copy-btn:hover {
					background-color: #455a64;
				}
				.copy-btn.copied {
					background-color: #2e7d32;
					border-color: #2e7d32;
				}
				
				/* Instructions Section */
				.instructions {
					margin-top: 40px;
					background-color: #252525;
					padding: 25px;
					border-radius: 10px;
					border: 1px solid #444;
				}
				.instructions h4 {
					color: #8ab4f8;
					margin-top: 0;
					margin-bottom: 15px;
					display: flex;
					align-items: center;
					gap: 8px;
				}
				.step {
					margin-bottom: 20px;
				}
				.step-title {
					font-weight: bold;
					color: #ddd;
					margin-bottom: 5px;
					display: block;
				}
				.code-block {
					background-color: #111;
					padding: 10px;
					border-radius: 6px;
					font-family: monospace;
					color: #a5d6a7; /* Light green terminal text */
					display: block;
					margin-top: 5px;
					border: 1px solid #333;
				}
				hr {
					border: none;
					border-top: 1px solid #444;
					margin-top: 30px;
				}
			</style>
		</head>
		<body>
		
			<div class="container">
				<h1>
					<svg class="icon icon-lg" viewBox="0 0 24 24">
						<rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
						<path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
					</svg>
					htpasswd Generator
				</h1>
				<p>Securely generate passwords and groups locally in your browser.</p>
				<p><i>note: this app runs fully in your local browser to generate all content. No passwords are sent to the server.</i></p>
				<form id="htpasswd-form">
					<div id="user-list-container">
						</div>
		
					<button type="button" id="add-user-btn" class="add-btn">
						<svg class="icon" viewBox="0 0 24 24">
							<line x1="12" y1="5" x2="12" y2="19"></line>
							<line x1="5" y1="12" x2="19" y2="12"></line>
						</svg>
						Add User
					</button>
					
					<button type="submit">Generate Files</button>
				</form>
				
				<hr>
		
				<h3>1. .htpasswd Content</h3>
				<div class="output-container">
					<pre id="htpasswd-output">Your .htpasswd lines will appear here...</pre>
					<button type="button" class="copy-btn" data-target="htpasswd-output">
						<svg class="icon" viewBox="0 0 24 24" style="width:16px; height:16px;">
							<path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
							<rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
						</svg>
						Copy
					</button>
				</div>
		
				<h3>2. AuthGroupFile Content</h3>
				<div class="output-container">
					<pre id="groupfile-output">Your group file lines will appear here...</pre>
					<button type="button" class="copy-btn" data-target="groupfile-output">
						<svg class="icon" viewBox="0 0 24 24" style="width:16px; height:16px;">
							<path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
							<rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
						</svg>
						Copy
					</button>
				</div>
		
				<div class="instructions">
					<h4>
						<svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
						Server Deployment Guide
					</h4>
					
					<div class="step">
						<span class="step-title">Step 1: Create the Password File</span>
						<span class="code-block">sudo nano /etc/apache2/.htpasswd</span>
						<div style="color:#aaa; font-size:0.85rem; margin-top:5px;">Paste the content from box #1 above. Press <code>Ctrl+O</code> to save, then <code>Ctrl+X</code> to exit.</div>
					</div>
		
					<div class="step">
						<span class="step-title">Step 2: Create the Group File</span>
						<span class="code-block">sudo nano /etc/apache2/.htgroups</span>
						<div style="color:#aaa; font-size:0.85rem; margin-top:5px;">Paste the content from box #2 above. Press <code>Ctrl+O</code> to save, then <code>Ctrl+X</code> to exit.</div>
					</div>
		
					<div class="step">
						<span class="step-title">Step 3: Update Apache Config</span>
						<span class="code-block">
		AuthType Basic
		AuthName "Restricted Access"
		AuthUserFile /etc/apache2/.htpasswd
		AuthGroupFile /etc/apache2/.htgroups
		Require group admin manager
						</span>
					</div>
				</div>
		
			</div>
		
			<script src="https://cdnjs.cloudflare.com/ajax/libs/bcryptjs/2.4.3/bcrypt.min.js"></script>
			
			<script>
				// --- ICON TEMPLATES (SVG Strings) ---
				const ICONS = {
					// Standard Eye
					eye: `<svg class="icon" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>`,
					
					// Eye With Slash (Fixed for better visibility)
					eyeOff: `<svg class="icon" viewBox="0 0 24 24"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>`,
					
					// Close (X)
					close: `<svg class="icon" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`,
					
					// Clipboard
					clipboard: `<svg class="icon" viewBox="0 0 24 24" style="width:16px; height:16px;"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>`,
					
					// Checkmark
					check: `<svg class="icon" viewBox="0 0 24 24" style="width:16px; height:16px;"><polyline points="20 6 9 17 4 12"></polyline></svg>`
				};
		
				document.addEventListener('DOMContentLoaded', function() {
					
					const form = document.getElementById('htpasswd-form');
					const userListContainer = document.getElementById('user-list-container');
					const addUserBtn = document.getElementById('add-user-btn');
					const htpasswdOutputEl = document.getElementById('htpasswd-output');
					const groupfileOutputEl = document.getElementById('groupfile-output');
		
					function addUserEntry() {
						const entryDiv = document.createElement('div');
						entryDiv.className = 'user-entry';
						
						entryDiv.innerHTML = `
							<div class="form-group">
								<label>Username</label>
								<input type="text" class="username" placeholder="e.g. john.doe" required>
							</div>
							<div class="form-group">
								<label>Password</label>
								<div class="password-wrapper">
									<input type="password" class="password" required>
									<button type="button" class="toggle-password" title="Show Password">${ICONS.eye}</button>
								</div>
							</div>
							<div class="form-group">
								<label>Access</label>
								<select class="access-level">
									<option value="user">User</option>
									<option value="staff">Staff</option>
									<option value="manager">Manager</option>
									<option value="admin">Admin</option>
								</select>
							</div>
							<button type="button" class="remove-btn" title="Remove user">${ICONS.close}</button>
						`;
						
						// Remove Logic
						entryDiv.querySelector('.remove-btn').addEventListener('click', function() {
							userListContainer.removeChild(entryDiv);
						});
		
						// Password Logic
						const passwordInput = entryDiv.querySelector('.password');
						const toggleBtn = entryDiv.querySelector('.toggle-password');
						let hideTimer = null;
		
						function startHideTimer() {
							clearTimeout(hideTimer);
							hideTimer = setTimeout(() => {
								passwordInput.type = 'password';
								toggleBtn.innerHTML = ICONS.eye;
							}, 5000); // 5 seconds
						}
		
						toggleBtn.addEventListener('click', function() {
							if (passwordInput.type === 'password') {
								// Show Password
								passwordInput.type = 'text';
								toggleBtn.innerHTML = ICONS.eyeOff; // Swaps to "Eye with Slash"
								startHideTimer();
							} else {
								// Hide Password
								passwordInput.type = 'password';
								toggleBtn.innerHTML = ICONS.eye;
								clearTimeout(hideTimer);
							}
						});
		
						passwordInput.addEventListener('input', function() {
							if (passwordInput.type === 'text') startHideTimer();
						});
						
						userListContainer.appendChild(entryDiv);
					}
		
					// Init with one user
					addUserEntry();
		
					// Add User Button
					addUserBtn.addEventListener('click', addUserEntry);
		
					// Generate Logic
					form.addEventListener('submit', function(event) {
						event.preventDefault(); 
						
						const userEntries = userListContainer.querySelectorAll('.user-entry');
						let htpasswdOutput = '';
						const groups = { admin: [], manager: [], staff: [], user: [] };
						let hasValidUser = false;
		
						userEntries.forEach(entry => {
							const username = entry.querySelector('.username').value;
							const password = entry.querySelector('.password').value;
							const level = entry.querySelector('.access-level').value;
		
							if (username && password) {
								try {
									const hash = dcodeIO.bcrypt.hashSync(password, 10);
									htpasswdOutput += `${username}:${hash}\n`;
									groups[level].push(username);
									hasValidUser = true;
								} catch (err) {
									htpasswdOutputEl.textContent = `Error: ${err.message}`;
									return;
								}
							}
						});
		
						if (!hasValidUser) {
							htpasswdOutputEl.textContent = 'Please add a valid username and password.';
							groupfileOutputEl.textContent = '...';
							return;
						}
		
						let groupfileOutput = '';
						for (const [groupName, users] of Object.entries(groups)) {
							if (users.length > 0) {
								groupfileOutput += `${groupName}: ${users.join(' ')}\n`;
							}
						}
						
						htpasswdOutputEl.textContent = htpasswdOutput.trim();
						groupfileOutputEl.textContent = groupfileOutput.trim();
		
						// Reset Copy Buttons
						document.querySelectorAll('.copy-btn').forEach(btn => {
							btn.innerHTML = `${ICONS.clipboard} Copy`;
							btn.classList.remove('copied');
						});
					});
		
					// Copy Logic
					document.querySelectorAll('.copy-btn').forEach(btn => {
						btn.addEventListener('click', function() {
							const targetId = btn.dataset.target;
							const outputEl = document.getElementById(targetId);
							const output = outputEl.textContent;
							
							if (!output.includes('...') && !output.startsWith('Error') && output.trim() !== '') {
								navigator.clipboard.writeText(output).then(() => {
									// Reset others
									document.querySelectorAll('.copy-btn').forEach(b => {
										b.innerHTML = `${ICONS.clipboard} Copy`;
										b.classList.remove('copied');
									});
									// Set Current
									btn.innerHTML = `${ICONS.check} Copied!`;
									btn.classList.add('copied');
								}).catch(() => alert('Failed to copy.'));
							}
						});
					});
				});
			</script>
		</body>
		</html>